<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lune de Miel - Japon & Philippines</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå∏</text></svg>">
    
    <!-- Leaflet CSS & FontAwesome -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <meta name="theme-color" content="#e91e63">

    <style>
        /* --- DESIGN SYSTEM --- */
        :root {
            --primary: #e91e63;
            --secondary: #2196f3;
            --japan: #bc002d;
            --philippines: #0038a8;
            --success: #4caf50;
            --suggestion: #ff9800;
            --text: #333;
            --bg: #f8f9fa;
            --gradient-jp-ph: linear-gradient(135deg, var(--japan) 0%, var(--philippines) 100%);
            --radius: 16px;
            --font-main: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, Helvetica, Arial, sans-serif;
            --header-height: 60px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: var(--font-main); 
            background: var(--bg); 
            color: var(--text); 
            overflow-x: hidden; 
            padding-bottom: 90px;
            font-size: 16px;
        }
        
        /* --- LANDING PAGE --- */
        #landing-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: var(--gradient-jp-ph);
            z-index: 2000; display: flex; flex-direction: column;
            align-items: center; justify-content: center; color: white;
            text-align: center; transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .btn-enter {
            padding: 18px 45px; background: white; color: var(--philippines);
            border: none; border-radius: 50px; font-size: 1.2rem; font-weight: bold;
            cursor: pointer; margin-top: 40px; transition: transform 0.2s; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
        }
        .btn-enter:active { transform: scale(0.95); }

        /* COUNTDOWN */
        .countdown-container { display: flex; gap: 10px; margin-top: 30px; justify-content: center; }
        .countdown-box {
            background: rgba(255, 255, 255, 0.25); backdrop-filter: blur(10px);
            padding: 12px 10px; border-radius: 12px; min-width: 75px;
            border: 1px solid rgba(255,255,255,0.4);
        }
        .countdown-number { font-size: 1.8rem; font-weight: 800; display: block; line-height: 1.1; }
        .countdown-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.95; font-weight: 600; }
        
        /* --- APP LAYOUT --- */
        #app-interface { display: none; opacity: 0; transition: opacity 0.5s; }
        
        header {
            position: sticky; top: 0; z-index: 1000;
            background: var(--gradient-jp-ph); color: white;
            height: var(--header-height); padding: 0 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }
        
        /* SIDEBAR */
        #sidebar {
            position: fixed; top: 0; left: -100%; width: 85%; max-width: 300px; height: 100vh;
            background: white; z-index: 1500; transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 2px 0 20px rgba(0,0,0,0.2); padding-top: var(--header-height);
        }
        #sidebar.active { left: 0; }
        .sidebar-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: rgba(0,0,0,0.6); z-index: 1400; display: none; backdrop-filter: blur(2px);
        }
        .nav-link {
            display: flex; align-items: center; padding: 20px 25px;
            color: var(--text); text-decoration: none; border-bottom: 1px solid #f0f0f0;
            font-weight: 500; font-size: 1.1rem;
        }
        .nav-link i { width: 35px; color: var(--primary); font-size: 1.2rem; }
        .nav-link:active { background: #f8f9fa; }
        
        /* SECTIONS */
        .section { display: none; padding: 20px 15px; max-width: 800px; margin: 0 auto; }
        .section.active { display: block; animation: fadeIn 0.4s; }
        
        /* --- PLANNING --- */
        .day-nav {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 25px; margin-top: 10px; background: white; padding: 5px;
            border-radius: 50px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .day-nav button {
            background: none; border: none; font-size: 1.5rem; width: 44px; height: 44px;
            display: flex; align-items: center; justify-content: center; color: var(--primary);
            border-radius: 50%; cursor: pointer;
        }
        .day-nav button:active { background: #eee; }
        #day-select {
            border: none; background: transparent; font-size: 1rem; font-weight: bold;
            color: var(--text); text-align: center; width: 100%; outline: none;
        }

        .day-card {
            background: white; border-radius: var(--radius); overflow: hidden;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08); margin-bottom: 25px;
            transition: transform 0.2s ease-out, opacity 0.2s ease-out; 
        }
        .day-header { padding: 25px 20px; color: white; display: flex; justify-content: space-between; align-items: center; }
        .bg-jp { background: var(--japan); }
        .bg-ph { background: var(--philippines); }
        .bg-intl { background: #607d8b; }
        
        /* OVERVIEW (VUE D'ENSEMBLE CARROUSEL) */
        #overview { max-width: 100% !important; padding: 20px 0 !important; }
        #overview h2, .overview-controls, .landscape-hint { max-width: 800px; margin-left: auto; margin-right: auto; padding: 0 15px; }
        
        .overview-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        
        .overview-grid { 
            display: flex; 
            overflow-x: auto; 
            gap: 15px; 
            padding: 10px 15px 30px 15px; 
            scroll-behavior: smooth; 
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x mandatory;
        }
        
        .overview-day {
            flex: 0 0 85%; 
            background: white; border-radius: 12px; padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); border-left: 5px solid var(--primary);
            display: flex; flex-direction: column;
            scroll-snap-align: center;
            min-height: 280px;
            transition: transform 0.2s;
        }
        
        @media (min-width: 768px) or (orientation: landscape) {
            .overview-day { flex: 0 0 28%; scroll-snap-align: start; }
        }
        @media (min-width: 1024px) {
            .overview-day { flex: 0 0 23%; }
        }

        .overview-date { font-weight: bold; color: var(--primary); margin-bottom: 5px; font-size: 1.1rem; }
        .overview-loc { font-size: 0.9rem; color: #666; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .overview-split-header { font-size: 0.75rem; text-transform: uppercase; color: #999; font-weight: bold; margin-top: 8px; margin-bottom: 4px; display: flex; align-items: center; gap: 5px; }
        .overview-act-list { list-style: none; padding: 0; margin: 0; }
        .overview-act-item { font-size: 0.85rem; margin-bottom: 4px; display: flex; gap: 6px; line-height: 1.3; }
        .overview-act-item::before { content: '‚Ä¢'; color: var(--secondary); font-weight: bold; }
        .overview-empty-slot { font-size: 0.75rem; color: #ccc; font-style: italic; margin-left: 10px; }
        .landscape-hint { background: #e3f2fd; color: #0d47a1; padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center; font-size: 0.9rem; display: none; }
        @media (orientation: portrait) { .landscape-hint { display: block; } }

        /* FLIGHTS SECTION */
        .flight-trip-card { background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 25px; }
        .flight-trip-header { background: #f1f5f9; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e2e8f0; }
        .flight-trip-title { font-weight: bold; color: var(--secondary); font-size: 1rem; display: flex; align-items: center; gap: 8px; }
        .flight-trip-date { font-size: 0.85rem; color: #64748b; background: white; padding: 4px 10px; border-radius: 20px; }
        .flight-baggage { padding: 12px 20px 0; font-size: 0.85rem; color: #475569; }
        .flight-baggage ul { margin: 8px 0 0 18px; padding: 0; }
        .flight-baggage li { margin-bottom: 6px; line-height: 1.3; }
        .baggage-icons { display: inline-flex; align-items: center; gap: 6px; margin-right: 6px; }
        .baggage-icon { font-size: 1rem; line-height: 1; }
        .baggage-icon.pa { color: #1e88e5; }
        .baggage-icon.coralie { color: #ec407a; }
        .flight-segment { display: flex; padding: 20px; position: relative; }
        .flight-segment:not(:last-child)::after { content: ''; position: absolute; bottom: 0; left: 80px; right: 20px; border-bottom: 1px dashed #e2e8f0; }
        .flight-times-col { display: flex; flex-direction: column; justify-content: space-between; min-width: 60px; text-align: right; padding-right: 15px; border-right: 2px solid var(--primary); position: relative; }
        .flight-time { font-weight: 800; font-size: 1.1rem; color: #333; }
        .flight-time-sub { font-size: 0.75rem; color: #999; }
        .flight-times-col::before, .flight-times-col::after { content: ''; position: absolute; right: -5px; width: 8px; height: 8px; background: white; border: 2px solid var(--primary); border-radius: 50%; }
        .flight-times-col::before { top: 5px; }
        .flight-times-col::after { bottom: 5px; }
        .flight-info-col { padding-left: 15px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .flight-route { font-size: 1rem; font-weight: bold; margin-bottom: 5px; color: #1e293b; }
        .flight-route span { color: var(--primary); margin: 0 5px; }
        .flight-airline { font-size: 0.85rem; color: #64748b; display: flex; align-items: center; gap: 5px; }
        .flight-badge { background: #e0f2f1; color: #00695c; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; margin-left: auto; }

        /* CHALLENGE CARD */
        .challenge-card {
            margin: 20px; background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white; border-radius: 12px; overflow: hidden;
        }
        .challenge-header { padding: 18px 20px; cursor: pointer; display: flex; align-items: center; gap: 12px; }
        .challenge-body { padding: 0 20px 20px; display: none; }
        .challenge-body.open { display: block; }
        .challenge-card.completed { background: var(--success); }
        
        /* CAMERA INPUT BUTTON */
        .camera-btn-label { display: block; width: 100%; padding: 15px; background: white; color: #333; border-radius: 25px; text-align: center; font-weight: bold; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .camera-btn-label:active { transform: scale(0.98); }
        .undo-btn { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.5); padding: 5px 10px; border-radius: 8px; font-size: 0.8rem; cursor: pointer; margin-left: 10px; }
        .timeline { padding: 10px 20px 25px; }
        .activity { border-left: 3px solid #eee; padding-left: 25px; margin-bottom: 25px; position: relative; }
        .activity:last-child { margin-bottom: 0; }
        .activity::before { content: ''; width: 12px; height: 12px; background: var(--primary); border-radius: 50%; position: absolute; left: -7px; top: 6px; box-shadow: 0 0 0 4px white; }
        
        /* CONVERTER */
        .converter-box { background: white; padding: 30px 20px; border-radius: var(--radius); box-shadow: 0 8px 25px rgba(0,0,0,0.08); text-align: center; display: flex; flex-direction: column; gap: 15px; }
        .currency-row { display: flex; flex-direction: column; gap: 10px; width: 100%; }
        @media (min-width: 480px) { .currency-row { flex-direction: row; } }
        .currency-select { padding: 16px; border: 1px solid #eee; border-radius: 12px; background: #fcfcfc; font-weight: bold; width: 100%; }
        .currency-input { padding: 16px; border: 1px solid #eee; border-radius: 12px; font-size: 1.4rem; font-weight: 500; width: 100%; text-align: center; }
        .btn-update { background: var(--secondary); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; width: 100%; font-weight: bold; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }

        /* H√îTELS - STYLES AJOUT√âS */
        .hotel-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .hotel-action-btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 15px;
            border-radius: 10px;
            border: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
        }
        
        .hotel-action-btn:active {
            transform: scale(0.97);
        }
        
        .hotel-call-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }
        
        .hotel-map-btn {
            background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);
            color: white;
            box-shadow: 0 4px 10px rgba(33, 150, 243, 0.3);
        }
        
        .hotel-website-btn {
            background: linear-gradient(135deg, #FF9800 0%, #EF6C00 100%);
            color: white;
            box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3);
        }
        
        /* ANIMATIONS & UTILS */
        @keyframes slideInRight { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideInLeft { from { transform: translateX(-30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .slide-in-right { animation: slideInRight 0.3s forwards; }
        .slide-in-left { animation: slideInLeft 0.3s forwards; }
        input, select, textarea { font-size: 16px !important; }
        .map-link { text-decoration: none; color: inherit; }
        .hotel-card { background: #fffde7; margin: 20px; padding: 20px; border-radius: 12px; border-left: 6px solid #fbc02d; }
        .hotel-badge { display: inline-block; background: white; padding: 4px 10px; border-radius: 20px; margin-right: 6px; margin-bottom: 6px; font-size: 0.85rem; border: 1px solid rgba(0,0,0,0.05); }
        #map-container { height: 65vh; border-radius: var(--radius); margin-top: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .custom-div-icon { background: transparent; border: none; }
        .marker-pin { width: 30px; height: 30px; border-radius: 50% 50% 50% 0; position: absolute; transform: rotate(-45deg); left: 50%; top: 50%; margin: -15px 0 0 -15px; box-shadow: 0 2px 5px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; }
        .marker-pin::after { content: ''; width: 20px; height: 20px; margin: 5px 0 0 5px; background: #fff; position: absolute; border-radius: 50%; }
        .marker-pin i { transform: rotate(45deg); z-index: 10; font-size: 14px; color: #333; }
        .user-pin { width: 20px; height: 20px; border-radius: 50%; background: #2196f3; border: 3px solid white; box-shadow: 0 0 0 4px rgba(33, 150, 243, 0.3); position: relative; }
        .user-pin::after { content: ''; width: 100%; height: 100%; border-radius: 50%; background: rgba(33, 150, 243, 0.5); position: absolute; top: 0; left: 0; animation: pulse 2s infinite; z-index: -1; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 0.8; } 70% { transform: scale(2.5); opacity: 0; } 100% { transform: scale(1); opacity: 0; } }
    </style>
</head>
<body>

    <!-- SCREEN D'ACCUEIL -->
    <div id="landing-page">
        <div class="landing-content">
            <h1>Lune de Miel</h1>
            <p>Japon & Philippines</p>
            <p style="font-size:1rem; opacity:0.9; margin-top:5px;">20 F√©v - 14 Mars 2026</p>
            <div class="countdown-container" id="countdown-display">
                <div class="countdown-box"><span class="countdown-number" id="cd-days">00</span><span class="countdown-label">Jours</span></div>
                <div class="countdown-box"><span class="countdown-number" id="cd-hours">00</span><span class="countdown-label">Heures</span></div>
                <div class="countdown-box"><span class="countdown-number" id="cd-minutes">00</span><span class="countdown-label">Min</span></div>
            </div>
            <button class="btn-enter" onclick="enterApp()">Commencer l'aventure</button>
        </div>
    </div>

    <!-- INTERFACE PRINCIPALE -->
    <div id="app-interface">
        <header>
            <button onclick="toggleSidebar()" style="background:none;border:none;color:white;font-size:1.5rem;padding:10px;"><i class="fas fa-bars"></i></button>
            <div style="font-weight: bold; font-size: 1.1rem;">Voyage de Noces</div>
            <div id="header-date" style="font-size:0.9rem; font-weight:500;">J-0</div>
        </header>

        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
        <nav id="sidebar">
            <button onclick="toggleSidebar()" style="position:absolute;top:15px;right:15px;background:none;border:none;font-size:1.8rem;padding:10px;color:#666;">&times;</button>
            <a href="#" class="nav-link" onclick="navigate('planner')"><i class="fas fa-calendar-alt"></i> Planning</a>
            <a href="#" class="nav-link" onclick="navigate('overview')"><i class="fas fa-th-large"></i> Vue Globale</a>
            <a href="#" class="nav-link" onclick="navigate('flights')"><i class="fas fa-plane"></i> Vols</a>
            <a href="#" class="nav-link" onclick="navigate('map')"><i class="fas fa-globe-asia"></i> Carte</a>
            <a href="#" class="nav-link" onclick="navigate('hotels')"><i class="fas fa-hotel"></i> H√©bergements</a>
            <a href="#" class="nav-link" onclick="navigate('converter')"><i class="fas fa-exchange-alt"></i> Convertisseur</a>
        </nav>

        <!-- 1. PLANNING -->
        <section id="planner" class="section active">
            <div class="day-nav">
                <button onclick="changeDay(-1)"><i class="fas fa-chevron-left"></i></button>
                <select id="day-select" onchange="selectDay(this.value)"></select>
                <button onclick="changeDay(1)"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div id="day-content"></div>
            <p style="text-align:center; color:#999; font-size:0.85rem; margin-top:15px; opacity:0.7;">
                <i class="fas fa-hand-pointer"></i> Glissez pour changer de jour
            </p>
        </section>

        <!-- 2. VUE GLOBALE (OVERVIEW) -->
        <section id="overview" class="section">
            <h2 style="margin-bottom:15px;">Vue d'ensemble</h2>
            <div class="landscape-hint"><i class="fas fa-mobile-alt fa-rotate-90"></i> Pivotez pour mieux voir !</div>
            <div class="overview-controls">
                <button onclick="scrollOverview('left')" style="background:none;border:none;font-size:1.5rem;"><i class="fas fa-arrow-left"></i></button>
                <span id="overview-range-label" style="font-weight:bold; font-size:0.9rem;">Planning Complet</span>
                <button onclick="scrollOverview('right')" style="background:none;border:none;font-size:1.5rem;"><i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="overview-grid" id="overview-container">
                <!-- Injected by JS -->
            </div>
        </section>

        <!-- 3. VOLS -->
        <section id="flights" class="section">
            <h2 style="margin-bottom:15px;">‚úàÔ∏è Vos Vols</h2>
            <div id="flights-container">
                <!-- Injected by JS -->
            </div>
        </section>

        <!-- 4. CARTE -->
        <section id="map" class="section">
            <h2 style="margin-bottom:15px;">üó∫Ô∏è Carte du Voyage</h2>
            <div class="map-legend" style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:15px; font-size:0.85rem;">
                <span style="display:flex; align-items:center;"><i class="fas fa-circle" style="color:var(--primary); margin-right:5px;"></i> Activit√©s</span>
                <span style="display:flex; align-items:center;"><i class="fas fa-circle" style="color:var(--secondary); margin-right:5px;"></i> H√¥tels</span>
                <span style="display:flex; align-items:center;"><i class="fas fa-circle" style="color:#2196f3; margin-right:5px; border:2px solid white; border-radius:50%;"></i> Moi</span>
            </div>
            <div id="map-container"></div>
        </section>
        
        <!-- 5. H√îTELS -->
        <section id="hotels" class="section">
            <h2 style="margin-bottom:15px;">üè® Vos H√©bergements</h2>
            <div id="hotels-list"></div>
        </section>

        <!-- 6. CONVERTISSEUR -->
        <section id="converter" class="section">
            <h2 style="margin-bottom:15px;">üí± Convertisseur</h2>
            <div class="converter-box">
                <div class="currency-row">
                    <select id="curr-from" onchange="convertCurrency()" class="currency-select">
                        <option value="EUR">EUR (‚Ç¨)</option>
                        <option value="JPY">JPY (¬•)</option>
                        <option value="PHP">PHP (‚Ç±)</option>
                    </select>
                    <input type="number" id="amount-from" value="100" oninput="convertCurrency()" placeholder="Montant" class="currency-input">
                </div>
                
                <button onclick="swapCurrency()" style="background:none; border:none; font-size:1.5rem; margin:5px 0; cursor:pointer; color:var(--primary);">
                    <i class="fas fa-exchange-alt" style="transform: rotate(90deg);"></i>
                </button>
                
                <div class="currency-row">
                    <select id="curr-to" onchange="convertCurrency()" class="currency-select">
                        <option value="JPY">JPY (¬•)</option>
                        <option value="PHP">PHP (‚Ç±)</option>
                        <option value="EUR">EUR (‚Ç¨)</option>
                    </select>
                    <div id="conversion-result" style="flex:1; padding:16px; text-align:center; font-size: 1.6rem; font-weight: 800; color: var(--primary);">---</div>
                </div>

                <div style="margin-top:25px; border-top:1px solid #eee; padding-top:20px; width:100%;">
                    <button onclick="updateRates()" id="btn-update-rates" class="btn-update">
                        <i class="fas fa-sync-alt"></i> Actualiser les taux
                    </button>
                    <p id="rate-info" style="font-size:0.85rem; color:#999; margin-top:12px;">Taux mis √† jour automatiquement</p>
                </div>
            </div>
        </section>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        /* --- CONFIG --- */
        const DATE_DEPART = new Date('2026-02-20T18:50:00');
        
        /* --- STATES --- */
        let realUserLocation = null;
        let userMarker = null;
        
        /* --- DONN√âES VOYAGE --- */
        const voyageData = {
            days: [
                { id: 1, date: new Date('2026-02-20'), country: 'International', location: 'Vol Paris ‚Üí Istanbul', coords: [48.8566, 2.3522], hotel: { name: "Nuit √† bord", room: "Vol TK1828/TK198", link: "#" }, challenge: { title: "‚úàÔ∏è Premier envol", desc: "Photo coucher soleil avion", hint: "Hublot" }, activities: [{ time: "18:50", title: "D√©part Paris CDG", desc: "Vol TK1828", coords: [49.0097, 2.5479] }, { time: "23:30", title: "Nuit √† bord", desc: "Vers Istanbul", coords: null }] },
                { id: 2, date: new Date('2026-02-21'), country: 'Japon', location: 'Tokyo (Ginza)', coords: [35.6712, 139.7665], hotel: { name: "The B Ginza", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=The+B+Ginza" }, challenge: { title: "üèôÔ∏è Premiers pas √† Ginza", desc: "N√©ons de Ginza", hint: "Buildings illumin√©s" }, activities: [{ time: "19:45", title: "Arriv√©e Haneda", desc: "Transfert h√¥tel", coords: [35.5494, 139.7798] }, { time: "22:00", title: "Ginza Nocturne", desc: "Exploration", coords: [35.6712, 139.7665] }], suggestions: [{ title: "Hibiya Park", desc: "Parc paisible", coords: [35.6736, 139.7564] }] },
                
                /* Jour 3 modifi√© - 22 f√©vrier */
                { id: 3, date: new Date('2026-02-22'), country: 'Japon', location: 'Tokyo (Asakusa/Ueno)', coords: [35.7148, 139.7967], hotel: { name: "The B Ginza", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=The+B+Ginza" }, challenge: { title: "‚õ©Ô∏è Temple Senso-ji", desc: "Sanctuaire Asakusa t√¥t le matin", hint: "Porte Kaminarimon" }, activities: [
                    { time: "09:00", title: "Temple Senso-ji", desc: "Sanctuaire Asakusa", coords: [35.7148, 139.7967] },
                    { time: "10:30", title: "Kappabashi Street", desc: "Rue des ustensiles de cuisine", coords: [35.7061, 139.7916] },
                    { time: "12:00", title: "Ameyoko Market", desc: "Pause d√©jeuner", coords: [35.7088, 139.7746] },
                    { time: "13:30", title: "Parc Ueno", desc: "Promenade dans le parc", coords: [35.7140, 139.7741] },
                    { time: "15:00", title: "Temple Nezu-jinja", desc: "Sanctuaire aux torii rouges", coords: [35.7165, 139.7615] }
                ], suggestions: [{ title: "Akihabara", desc: "Quartier √©lectronique & anime", coords: [35.7023, 139.7745] }] },
                
                /* Jour 4 modifi√© - 23 f√©vrier */
                { id: 4, date: new Date('2026-02-23'), country: 'Japon', location: 'Tokyo (Ginza/Odaiba)', coords: [35.6284, 139.7775], hotel: { name: "The B Ginza", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=The+B+Ginza" }, challenge: { title: "üõçÔ∏è Shopping Ginza", desc: "Boutiques de luxe seconde main", hint: "Vintage stores" }, activities: [
                    { time: "10:00", title: "Ginza", desc: "Boutiques 2nde main luxe", coords: [35.6712, 139.7665] },
                    { time: "13:00", title: "Palais Imp√©rial", desc: "Jardins et visite ext√©rieure", coords: [35.6852, 139.7528] },
                    { time: "17:00", title: "TeamLab Planets", desc: "Art num√©rique immersif", coords: [35.6442, 139.7954] },
                    { time: "19:30", title: "Odaiba", desc: "D√Æner et vue sur la baie", coords: [35.6284, 139.7775] }
                ], suggestions: [{ title: "Gundam Statue", desc: "Robot g√©ant √† Odaiba", coords: [35.6244, 139.7755] }] },
                
                /* Jour 5 modifi√© - 24 f√©vrier */
                { id: 5, date: new Date('2026-02-24'), country: 'Japon', location: 'Tokyo (Shinjuku)', coords: [35.6917, 139.7040], hotel: { name: "The B Ginza", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=The+B+Ginza" }, challenge: { title: "üèôÔ∏è Vue panoramique", desc: "Skyline depuis Sunshine 60", hint: "Coucher de soleil" }, activities: [
                    { time: "09:30", title: "Hie-jinja", desc: "Sanctuaire shinto", coords: [35.6746, 139.7400] },
                    { time: "13:00", title: "Sunshine 60", desc: "Observatoire panoramique", coords: [35.7295, 139.7180] },
                    { time: "18:00", title: "Shinjuku", desc: "N√©ons et quartier anim√©", coords: [35.6917, 139.7040] }
                ], suggestions: [{ title: "Omoide Yokocho", desc: "Ruelle r√©tro et izakayas", coords: [35.6930, 139.6996] }] },
                
                /* Jour 6 modifi√© - 25 f√©vrier */
                { id: 6, date: new Date('2026-02-25'), country: 'Japon', location: 'Furano', coords: [43.3421, 142.3832], hotel: { name: "Winery Hotel Furano", room: "Vue Montagne", link: "https://www.google.com/maps/search/?api=1&query=Winery+Hotel+Furano" }, challenge: { title: "üèîÔ∏è Arriv√©e montagne", desc: "Vue sur les montagnes enneig√©es", hint: "Depuis l'h√¥tel" }, activities: [
                    { time: "11:10", title: "Vol vers Asahikawa", desc: "D√©part pour Hokkaido", coords: [35.5494, 139.7798] },
                    { time: "16:30", title: "Mat√©riel Ski", desc: "Location √©quipement", coords: [43.3340, 142.3620] }
                ], suggestions: [{ title: "Ningle Terrace", desc: "Cabanes artisanales", coords: [43.3252, 142.3563] }] },
                
                /* Jour 7 modifi√© - 26 f√©vrier */
                { id: 7, date: new Date('2026-02-26'), country: 'Japon', location: 'Furano', coords: [43.3421, 142.3832], hotel: { name: "Winery Hotel Furano", room: "Vue Montagne", link: "https://www.google.com/maps/search/?api=1&query=Winery+Hotel+Furano" }, challenge: { title: "‚õ∑Ô∏è Premi√®res pistes", desc: "Photo sur les pistes de Furano", hint: "Piste bleue num√©ro 5" }, activities: [
                    { time: "09:30", title: "Ski Furano", desc: "Journ√©e ski", coords: [43.3340, 142.3620] },
                    { time: "17:30", title: "Onsen", desc: "Bain thermal relaxant", coords: [43.3421, 142.3832] }
                ], suggestions: [] },
                
                /* Jour 8 modifi√© - 27 f√©vrier */
                { id: 8, date: new Date('2026-02-27'), country: 'Japon', location: 'Furano', coords: [43.3421, 142.3832], hotel: { name: "Winery Hotel Furano", room: "Vue Montagne", link: "https://www.google.com/maps/search/?api=1&query=Winery+Hotel+Furano" }, challenge: { title: "üéø Progression", desc: "Nouvelle piste ma√Ætris√©e", hint: "Piste rouge" }, activities: [
                    { time: "09:30", title: "Ski Furano", desc: "Journ√©e ski", coords: [43.3340, 142.3620] }
                ], suggestions: [{ title: "Furano Delice", desc: "P√¢tisserie locale", coords: [43.3350, 142.3650] }] },
                
                /* Jour 9 modifi√© - 28 f√©vrier */
                { id: 9, date: new Date('2026-02-28'), country: 'Japon', location: 'Furano', coords: [43.3421, 142.3832], hotel: { name: "Winery Hotel Furano", room: "Vue Montagne", link: "https://www.google.com/maps/search/?api=1&query=Winery+Hotel+Furano" }, challenge: { title: "‚õ∑Ô∏è Derni√®re ligne droite", desc: "Photo au sommet du domaine", hint: "Point culminant" }, activities: [
                    { time: "09:30", title: "Ski Furano", desc: "Journ√©e ski", coords: [43.3340, 142.3620] }
                ], suggestions: [] },
                
                /* Jour 10 modifi√© - 1er mars */
                { id: 10, date: new Date('2026-03-01'), country: 'Japon', location: 'Furano', coords: [43.3421, 142.3832], hotel: { name: "Winery Hotel Furano", room: "Vue Montagne", link: "https://www.google.com/maps/search/?api=1&query=Winery+Hotel+Furano" }, challenge: { title: "‚ùÑÔ∏è Derni√®re descente", desc: "Photo avec l'√©quipement", hint: "Devant la station" }, activities: [
                    { time: "09:30", title: "Ski Furano", desc: "Derni√®re matin√©e ski", coords: [43.3340, 142.3620] },
                    { time: "19:00", title: "D√Æner Adieu Hokkaido", desc: "Repas de fin de s√©jour", coords: [43.3428, 142.3860] }
                ], suggestions: [] },
                
                /* Jour 11 modifi√© - 2 mars */
                { id: 11, date: new Date('2026-03-02'), country: 'Japon', location: 'Kyoto', coords: [34.9858, 135.7588], hotel: { name: "Insomnia KYOTO OIKE", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=Insomnia+Kyoto+Oike" }, challenge: { title: "üéé Arriv√©e Kyoto", desc: "Premi√®re vue sur Kyoto", hint: "Gare de Kyoto" }, activities: [
                    { time: "14:00", title: "Vol vers Osaka", desc: "D√©part pour Kansai", coords: [43.6708, 142.4537] },
                    { time: "18:30", title: "Arriv√©e Kyoto", desc: "Installation √† l'h√¥tel", coords: [35.0116, 135.7600] }
                ], suggestions: [{ title: "Kyoto Tower", desc: "Vue nocturne", coords: [34.9875, 135.7593] }] },
                
                /* Jour 12 - 3 mars (Proposition Kyoto) */
                { id: 12, date: new Date('2026-03-03'), country: 'Japon', location: 'Kyoto (Fushimi Inari)', coords: [34.9671, 135.7727], hotel: { name: "Insomnia KYOTO OIKE", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=Insomnia+Kyoto+Oike" }, challenge: { title: "‚õ©Ô∏è Torii infinis", desc: "Photo dans les tunnels de torii", hint: "Haut de la colline" }, activities: [
                    { time: "08:00", title: "Fushimi Inari", desc: "Sanctuaire aux milliers de torii", coords: [34.9671, 135.7727] },
                    { time: "12:00", title: "Nishiki Market", desc: "D√©jeuner et d√©couvertes culinaires", coords: [35.0050, 135.7649] },
                    { time: "14:00", title: "Gion", desc: "Quartier des geishas", coords: [35.0037, 135.7778] },
                    { time: "19:00", title: "Pontocho", desc: "D√Æner dans l'all√©e historique", coords: [35.0064, 135.7709] }
                ], suggestions: [{ title: "Kiyomizu-dera", desc: "Temple sur pilotis", coords: [34.9949, 135.7850] }] },
                
                /* Jour 13 - 4 mars (Proposition Kyoto) */
                { id: 13, date: new Date('2026-03-04'), country: 'Japon', location: 'Kyoto (Arashiyama)', coords: [35.0169, 135.6713], hotel: { name: "Insomnia KYOTO OIKE", room: "Chambre Double", link: "https://www.google.com/maps/search/?api=1&query=Insomnia+Kyoto+Oike" }, challenge: { title: "üéã For√™t de bambous", desc: "Photo dans la c√©l√®bre for√™t", hint: "T√¥t le matin" }, activities: [
                    { time: "09:00", title: "For√™t de bambous", desc: "Balade dans Arashiyama", coords: [35.0169, 135.6713] },
                    { time: "11:00", title: "Temple Tenryu-ji", desc: "Temple et jardin zen", coords: [35.0160, 135.6740] },
                    { time: "13:00", title: "Pont Togetsukyo", desc: "Vue sur la rivi√®re", coords: [35.0158, 135.6777] },
                    { time: "15:00", title: "Monkey Park", desc: "Singes et vue sur Kyoto", coords: [35.0094, 135.6744] }
                ], suggestions: [{ title: "Sagano Romantic Train", desc: "Train panoramique", coords: [35.0169, 135.6713] }] },
                
                /* Jour 14 - 5 mars (Transfert Osaka) */
                { id: 14, date: new Date('2026-03-05'), country: 'Japon', location: 'Osaka', coords: [34.6937, 135.5023], hotel: { name: "Centara Grand Hotel", room: "Chambre Deluxe", link: "https://www.google.com/maps/search/?api=1&query=Centara+Grand+Hotel+Osaka" }, challenge: { title: "üèØ Ch√¢teau d'Osaka", desc: "Photo devant le ch√¢teau", hint: "Depuis le parc" }, activities: [
                    { time: "10:00", title: "Transfert Osaka", desc: "Train pour Osaka", coords: [35.0116, 135.7600] },
                    { time: "12:00", title: "Ch√¢teau d'Osaka", desc: "Visite ext√©rieure et parc", coords: [34.6873, 135.5262] },
                    { time: "14:00", title: "Shinsaibashi", desc: "Shopping et d√©jeuner", coords: [34.6724, 135.5003] },
                    { time: "19:00", title: "Dotonbori", desc: "N√©ons et street food", coords: [34.6699, 135.5018] }
                ], suggestions: [{ title: "Umeda Sky Building", desc: "Observatoire panoramique", coords: [34.7050, 135.4900] }] },
                
                /* Jour 15 - 6 mars (Vol pour Philippines) */
                { id: 15, date: new Date('2026-03-06'), country: 'International', location: 'Vol vers Manille', coords: [34.7855, 135.4382], hotel: { name: "Nuit √† bord", room: "Vol PR411", link: "#" }, challenge: { title: "üëã Adieu Japon", desc: "Derni√®re photo au Japon", hint: "A√©roport Kansai" }, activities: [
                    { time: "10:00", title: "Derniers achats", desc: "Souvenirs √† Osaka", coords: [34.6937, 135.5023] },
                    { time: "16:00", title: "Transfert a√©roport", desc: "Vers Kansai (KIX)", coords: [34.4320, 135.2304] },
                    { time: "19:35", title: "Vol PR411", desc: "Osaka ‚Üí Manille", coords: [34.4320, 135.2304] },
                    { time: "23:15", title: "Arriv√©e Manille", desc: "Nuit √† l'a√©roport", coords: [14.51, 121.01] }
                ], suggestions: [] },
                
                /* Suite du voyage existante (Philippines) */
                { id: 16, date: new Date('2026-03-07'), country: 'Philippines', location: 'Bohol (Loboc)', coords: [9.6378, 124.0331], hotel: { name: "Fox & The Firefly", room: "Cottage", link: "https://www.google.com/maps/search/?api=1&query=Fox+and+The+Firefly+Bohol" }, challenge: { title: "üå¥ Arriv√©e Bohol", desc: "Lodge & Rivi√®re", hint: "Terrasse" }, activities: [
                    { time: "05:20", title: "Vol vers Panglao", desc: "PR2773 Manille ‚Üí Tagbilaran", coords: [14.51, 121.01] },
                    { time: "08:30", title: "Arriv√©e Bohol", desc: "Installation au lodge", coords: [9.6378, 124.0331] },
                    { time: "20:00", title: "Lucioles", desc: "Tour en bateau sur la rivi√®re", coords: [9.6385, 124.0300] }
                ], suggestions: [] },
                { id: 17, date: new Date('2026-03-08'), country: 'Philippines', location: 'Bohol (Centre)', coords: [9.8297, 124.1397], hotel: { name: "Fox & The Firefly", room: "Cottage", link: "https://www.google.com/maps/search/?api=1&query=Fox+and+The+Firefly+Bohol" }, challenge: { title: "üç´ Chocolate Hills", desc: "Vue collines", hint: "Plateforme" }, activities: [
                    { time: "09:00", title: "Chocolate Hills", desc: "Visite", coords: [9.8297, 124.1397] },
                    { time: "10:30", title: "Tarsiers", desc: "Sanctuaire", coords: [9.6918, 124.0096] },
                    { time: "12:30", title: "Croisi√®re Loboc", desc: "D√©jeuner flottant", coords: [9.6391, 124.0299] }
                ], suggestions: [{ title: "Man Made Forest", desc: "For√™t acajou", coords: [9.6960, 124.0710] }] },
                { id: 18, date: new Date('2026-03-09'), country: 'Philippines', location: 'Panglao', coords: [9.55, 123.77], hotel: { name: "Amorita Resort", room: "Suite Luxe", link: "https://www.google.com/maps/search/?api=1&query=Amorita+Resort+Bohol" }, challenge: { title: "üèùÔ∏è Resort", desc: "Infinity Pool", hint: "Coucher soleil" }, activities: [
                    { time: "11:00", title: "Amorita Resort", desc: "Installation", coords: [9.5483, 123.7764] },
                    { time: "18:00", title: "Sunset", desc: "Plage", coords: [9.5480, 123.7760] }
                ], suggestions: [{ title: "Alona Beach", desc: "Bars et restaurants", coords: [9.5483, 123.7764] }] },
                { id: 19, date: new Date('2026-03-10'), country: 'Philippines', location: 'Balicasag', coords: [9.5191, 123.6811], hotel: { name: "Amorita Resort", room: "Suite Luxe", link: "https://www.google.com/maps/search/?api=1&query=Amorita+Resort+Bohol" }, challenge: { title: "üê† Plong√©e", desc: "Selfie sous-marin", hint: "R√©cif" }, activities: [
                    { time: "09:00", title: "Plong√©e PADI", desc: "Balicasag", coords: [9.5191, 123.6811] },
                    { time: "16:00", title: "Retour Resort", desc: "D√©tente", coords: [9.5483, 123.7764] }
                ], suggestions: [] },
                { id: 20, date: new Date('2026-03-11'), country: 'Philippines', location: 'Panglao', coords: [9.55, 123.77], hotel: { name: "Amorita Resort", room: "Suite Luxe", link: "https://www.google.com/maps/search/?api=1&query=Amorita+Resort+Bohol" }, challenge: { title: "üê¨ Dauphins", desc: "Photo en mer", hint: "Bateau" }, activities: [
                    { time: "08:00", title: "Dauphins", desc: "Excursion matinale", coords: [9.5300, 123.7500] },
                    { time: "19:00", title: "D√Æner Plage", desc: "Romantique", coords: [9.5483, 123.7764] }
                ], suggestions: [{ title: "Hinagdanan Cave", desc: "Grotte", coords: [9.6250, 123.8000] }] },
                { id: 21, date: new Date('2026-03-12'), country: 'Philippines', location: 'Panglao', coords: [9.55, 123.77], hotel: { name: "Amorita Resort", room: "Suite Luxe", link: "https://www.google.com/maps/search/?api=1&query=Amorita+Resort+Bohol" }, challenge: { title: "üåÖ Sunset", desc: "Photo romantique", hint: "Sable" }, activities: [
                    { time: "09:00", title: "D√©tente Resort", desc: "Piscine et plage", coords: [9.5483, 123.7764] },
                    { time: "18:00", title: "D√Æner Adieu Philippines", desc: "Dernier repas", coords: [9.5483, 123.7764] }
                ], suggestions: [] },
                { id: 22, date: new Date('2026-03-13'), country: 'International', location: 'Vol Retour', coords: [14.51, 121.01], hotel: { name: "Nuit √† bord", room: "Vol EK335", link: "#" }, challenge: { title: "üëã Adieu Philippines", desc: "Derni√®re photo", hint: "A√©roport" }, activities: [
                    { time: "14:00", title: "Check-out", desc: "D√©part resort", coords: [9.5483, 123.7764] },
                    { time: "18:50", title: "Vol Manille ‚Üí Dubai", desc: "EK335", coords: [14.51, 121.01] }
                ], suggestions: [] },
                { id: 23, date: new Date('2026-03-14'), country: 'France', location: 'Arriv√©e Paris', coords: [48.8566, 2.3522], hotel: { name: "Maison", room: "Chez vous", link: "#" }, challenge: { title: "üè† Retour", desc: "Arriv√©e Paris", hint: "Hall CDG" }, activities: [
                    { time: "07:50", title: "Vol Dubai ‚Üí Paris", desc: "EK073", coords: null },
                    { time: "12:25", title: "Arriv√©e Paris CDG", desc: "Fin du voyage", coords: [49.0097, 2.5479] }
                ], suggestions: [] }
            ],
            hotels: [
                { 
                    name: "The B Ginza", 
                    city: "Tokyo", 
                    stars: 4, 
                    coords: [35.6695, 139.7615], 
                    phone: "+81335431200", 
                    website: "https://www.theb-hotels.com/theb/ginza",
                    checkIn: "15:00", 
                    checkOut: "11:00", 
                    amenities: ["Wifi", "Caf√© gratuit", "Clim", "Centre ville"], 
                    desc: "H√¥tel moderne au c≈ìur du quartier chic de Ginza. Id√©al pour le shopping et les d√Æners."
                },
                { 
                    name: "Winery Hotel Furano", 
                    city: "Furano", 
                    stars: 4, 
                    coords: [43.3421, 142.3832], 
                    phone: "+81167238778", 
                    website: "https://hotel-hitohana.com/",
                    checkIn: "15:00", 
                    checkOut: "10:00", 
                    amenities: ["Onsen", "Vue Montagne", "Navette Ski", "Restaurant"], 
                    desc: "H√¥tel perch√© avec vue panoramique sur les montagnes et vignobles."
                },
                { 
                    name: "Insomnia KYOTO OIKE", 
                    city: "Kyoto", 
                    stars: 4, 
                    coords: [35.0116, 135.7600], 
                    phone: "+81752217700", 
                    website: "https://www.inso-mnia.com/kyoto/",
                    checkIn: "14:00", 
                    checkOut: "11:00", 
                    amenities: ["Design", "Wifi", "Bar 24h", "Central"], 
                    desc: "H√¥tel moderne et artistique id√©alement situ√© pr√®s du march√© Nishiki et des transports."
                },
                { 
                    name: "Centara Grand Hotel", 
                    city: "Osaka", 
                    stars: 5, 
                    coords: [34.6595, 135.5009], 
                    phone: "+81666169945", 
                    website: "https://www.centarahotelsresorts.com/centaragrand/fr/cgoj",
                    checkIn: "14:00", 
                    checkOut: "12:00", 
                    amenities: ["Spa", "Piscine", "Vue ville", "Restaurants"], 
                    desc: "H√¥tel de luxe au centre d'Osaka avec vue imprenable et services haut de gamme."
                },
                { 
                    name: "Fox & The Firefly", 
                    city: "Loboc", 
                    stars: 3, 
                    coords: [9.6378, 124.0331], 
                    phone: "+63384220700", 
                    website: "https://www.foxandthefireflycottages.com/",
                    checkIn: "14:00", 
                    checkOut: "12:00", 
                    amenities: ["Eco-Lodge", "Bord rivi√®re", "Nature", "Paddle"], 
                    desc: "Cottages en bambou au bord de la rivi√®re Loboc. Ambiance nature et d√©connect√©e."
                },
                { 
                    name: "Amorita Resort", 
                    city: "Panglao", 
                    stars: 5, 
                    coords: [9.5483, 123.7764], 
                    phone: "+63289319999", 
                    website: "https://www.amoritaresort.com/amoritabohol",
                    checkIn: "14:00", 
                    checkOut: "12:00", 
                    amenities: ["Infinity Pool", "Plage priv√©e", "Spa", "Plong√©e"], 
                    desc: "Luxe discret sur une falaise surplombant la plage d'Alona. Calme et volupt√©."
                }
            ]
        };

        let currentDayIndex = 0;
        let map = null;
        let exchangeRates = { "EUR-JPY": 162.50, "JPY-EUR": 0.0061, "EUR-PHP": 61.20, "PHP-EUR": 0.016 };

        document.addEventListener('DOMContentLoaded', () => {
            startCountdown();
            renderDayNav();
            renderDay(0);
            renderHotels();
            setupSwipe();
            initGeo(); 
            renderOverview(); 
            renderFlights(); 
        });

        /* --- GEOLOCATION --- */
        function initGeo() {
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(
                    (pos) => {
                        realUserLocation = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                        if (map) updateUserMarker();
                    },
                    (err) => console.log("GPS Error", err),
                    { enableHighAccuracy: true }
                );
            }
        }

        /* --- COMPTE √Ä REBOURS --- */
        function startCountdown() {
            const update = () => {
                const now = new Date().getTime();
                const distance = DATE_DEPART.getTime() - now;
                if (distance < 0) {
                    document.getElementById('countdown-display').innerHTML = "<h3>EN VOYAGE ! ‚úàÔ∏è</h3>";
                    document.getElementById("header-date").innerText = "J-0";
                    return;
                }
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                document.getElementById("cd-days").innerText = days < 10 ? "0"+days : days;
                document.getElementById("cd-hours").innerText = hours < 10 ? "0"+hours : hours;
                document.getElementById("cd-minutes").innerText = minutes < 10 ? "0"+minutes : minutes;
                document.getElementById("header-date").innerText = "J-" + days;
            };
            setInterval(update, 1000);
            update();
        }

        /* --- NAVIGATION --- */
        function navigate(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            toggleSidebar();
            
            if(id === 'map' && map) {
                setTimeout(() => map.invalidateSize(), 200);
                updateUserMarker();
            }
            if(id === 'converter') updateRates();
        }
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            const overlay = document.querySelector('.sidebar-overlay');
            if(overlay) overlay.style.display = document.getElementById('sidebar').classList.contains('active') ? 'block' : 'none';
        }

        /* --- OVERVIEW LOGIC --- */
        function renderOverview() {
            const container = document.getElementById('overview-container');
            
            container.innerHTML = voyageData.days.map(d => {
                const morningActs = d.activities.filter(a => parseInt(a.time.split(':')[0]) < 12);
                const afternoonActs = d.activities.filter(a => parseInt(a.time.split(':')[0]) >= 12);

                return `
                <div class="overview-day" onclick="selectDay(${d.id-1}); navigate('planner')">
                    <div class="overview-date">${d.date.toLocaleDateString('fr-FR', {weekday:'short', day:'numeric', month:'short'})}</div>
                    <div class="overview-loc"><i class="fas fa-map-pin"></i> ${d.location}</div>
                    
                    <div class="overview-split-header"><i class="fas fa-sun" style="color:#fbc02d;"></i> Matin</div>
                    <ul class="overview-act-list">
                        ${morningActs.length > 0 ? morningActs.map(a => `<li class="overview-act-item">${a.time} - ${a.title}</li>`).join('') : '<li class="overview-empty-slot">Repos / Libre</li>'}
                    </ul>

                    <div class="overview-split-header"><i class="fas fa-moon" style="color:#5c6bc0;"></i> Apr√®s-midi</div>
                    <ul class="overview-act-list">
                        ${afternoonActs.length > 0 ? afternoonActs.map(a => `<li class="overview-act-item">${a.time} - ${a.title}</li>`).join('') : '<li class="overview-empty-slot">Repos / Libre</li>'}
                    </ul>
                </div>`;
            }).join('');
        }

        function scrollOverview(direction) {
            const container = document.getElementById('overview-container');
            const scrollAmount = container.clientWidth * 0.85; 
            
            if(direction === 'left') {
                container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
            } else {
                container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            }
        }

        /* --- FLIGHTS LOGIC --- */
        function renderFlights() {
            const flightItinerary = [
                {
                    title: "D√©part de Paris : France ‚Üí Japon",
                    date: "20 F√©vrier 2026",
                    baggage: [
                        {
                            same: true,
                            people: ["PA", "Coralie"],
                            detail: "Turkish Airlines (Paris ‚Üí Tokyo) ‚Äî 2 valises en soute de 23 kg + 1 valise cabine jusqu'√† 8 kg."
                        }
                    ],
                    flights: [
                        {
                            depCode: "CDG", depCity: "Paris", depTime: "18:50",
                            arrCode: "IST", arrCity: "Istanbul", arrTime: "23:30",
                            flightNum: "TK1828", airline: "Turkish Airlines"
                        },
                        {
                            depCode: "IST", depCity: "Istanbul", depTime: "02:30",
                            arrCode: "HND", arrCity: "Tokyo", arrTime: "19:45",
                            flightNum: "TK198", airline: "Turkish Airlines", nextDay: true
                        }
                    ]
                },
                {
                    title: "Objectif neige : Tokyo ‚Üí Hokkaido",
                    date: "25 F√©vrier 2026",
                    baggage: [
                        {
                            same: true,
                            people: ["PA", "Coralie"],
                            detail: "Tokyo ‚Üí Asahikawa ‚Äî 1 valise en soute de 20 kg + 1 bagage cabine de 10 kg."
                        }
                    ],
                    flights: [
                        {
                            depCode: "HND", depCity: "Tokyo", depTime: "11:10",
                            arrCode: "AKJ", arrCity: "Asahikawa", arrTime: "12:50",
                            flightNum: "JAL553", airline: "JAL"
                        }
                    ]
                },
                {
                    title: "Vol vers Kyoto: Hokkaido ‚Üí Kansai",
                    date: "02 Mars 2026",
                    baggage: [
                        {
                            same: true,
                            people: ["PA", "Coralie"],
                            detail: "Sapporo ‚Üí Osaka ‚Äî 1 valise en soute de 20 kg + 1 bagage cabine de 10 kg."
                        }
                    ],
                    flights: [
                        {
                            depCode: "CTS", depCity: "Sapporo", depTime: "14:00",
                            arrCode: "ITM", arrCity: "Osaka", arrTime: "16:05",
                            flightNum: "ANA984", airline: "ANA"
                        }
                    ]
                },
                {
                    title: "Au Soleil! : Japon ‚Üí Philippines",
                    date: "06 Mars 2026",
                    baggage: [
                        {
                            same: false,
                            people: ["PA"],
                            detail: "Osaka ‚Üí Bohol ‚Äî 2 valises en soute de 20 kg + 1 bagage cabine."
                        },
                        {
                            same: false,
                            people: ["Coralie"],
                            detail: "Osaka ‚Üí Bohol ‚Äî 1 valise en soute de 20 kg + 1 bagage cabine."
                        }
                    ],
                    flights: [
                        {
                            depCode: "KIX", depCity: "Osaka", depTime: "19:35",
                            arrCode: "MNL", arrCity: "Manille", arrTime: "23:15",
                            flightNum: "PR411", airline: "Philippine Airlines"
                        },
                        {
                            depCode: "MNL", depCity: "Manille", depTime: "05:20",
                            arrCode: "TAG", arrCity: "Panglao", arrTime: "06:55",
                            flightNum: "PR2773", airline: "PAL Express", nextDay: true
                        }
                    ]
                },
                {
                    title: "Patounes en approche : Philippines ‚Üí France",
                    date: "13 Mars 2026",
                    baggage: [
                        {
                            same: true,
                            people: ["PA", "Coralie"],
                            detail: "Bohol ‚Üí Paris ‚Äî 1 valise en soute de 25 kg + 1 bagage cabine."
                        }
                    ],
                    flights: [
                        {
                            depCode: "TAG", depCity: "Panglao", depTime: "18:50",
                            arrCode: "MNL", arrCity: "Manille", arrTime: "20:25",
                            flightNum: "PR2778", airline: "PAL Express"
                        },
                        {
                            depCode: "MNL", depCity: "Manille", depTime: "23:30",
                            arrCode: "DXB", arrCity: "Dubai", arrTime: "04:45",
                            flightNum: "EK335", airline: "Emirates", nextDay: true
                        },
                        {
                            depCode: "DXB", depCity: "Dubai", depTime: "07:50",
                            arrCode: "CDG", arrCity: "Paris", arrTime: "12:25",
                            flightNum: "EK073", airline: "Emirates"
                        }
                    ]
                }
            ];

            const container = document.getElementById('flights-container');
            
            container.innerHTML = flightItinerary.map(trip => `
                <div class="flight-trip-card">
                    <div class="flight-trip-header">
                        <div class="flight-trip-title"><i class="fas fa-plane-departure"></i> ${trip.title}</div>
                        <div class="flight-trip-date">${trip.date}</div>
                    </div>
                    ${trip.baggage ? `
                        <div class="flight-baggage">
                            <strong>Bagages :</strong>
                            <ul>
                                ${trip.baggage.map(item => {
                                    const icons = item.people.map(person => {
                                        const cls = person === "PA" ? "pa" : "coralie";
                                        return `<span class="baggage-icon ${cls}" title="${person}">üß≥</span>`;
                                    }).join('');
                                    return `
                                        <li>
                                            <span class="baggage-icons">${icons}</span>
                                            ${item.detail}
                                        </li>
                                    `;
                                }).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    ${trip.flights.map(segment => `
                        <div class="flight-segment">
                            <div class="flight-times-col">
                                <div class="flight-time">${segment.depTime}</div>
                                <div class="flight-time-sub">${segment.depCode}</div>
                                
                                <div style="flex:1; min-height:20px; border-right:2px dashed #ccc; margin-right:-2px;"></div>
                                
                                <div class="flight-time">${segment.arrTime} ${segment.nextDay ? '<sup style="color:#e91e63; font-size:0.6rem;">+1</sup>' : ''}</div>
                                <div class="flight-time-sub">${segment.arrCode}</div>
                            </div>
                            <div class="flight-info-col">
                                <div class="flight-route">
                                    <strong>${segment.depCity}</strong> <span>‚úà</span> <strong>${segment.arrCity}</strong>
                                </div>
                                <div class="flight-airline">
                                    <i class="fas fa-ticket-alt"></i> ${segment.airline}
                                    <span class="flight-badge">${segment.flightNum}</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        /* --- PLANNING --- */
        function renderDayNav() {
            const select = document.getElementById('day-select');
            select.innerHTML = "";
            voyageData.days.forEach((day, index) => {
                const opt = document.createElement('option');
                opt.value = index;
                opt.text = `Jour ${day.id} - ${day.date.toLocaleDateString('fr-FR', {day:'numeric', month:'short'})}`;
                select.appendChild(opt);
            });
        }

        function selectDay(index, direction = null) { 
            currentDayIndex = parseInt(index); 
            renderDay(currentDayIndex, direction);
        }
        
        function changeDay(offset, direction = null) {
            let newIndex = currentDayIndex + offset;
            if(newIndex >= 0 && newIndex < voyageData.days.length) {
                if (!direction) direction = offset > 0 ? 'right' : 'left';
                selectDay(newIndex, direction);
                document.getElementById('day-select').value = newIndex;
            }
        }

        function renderDay(index, direction = null) {
            const day = voyageData.days[index];
            const container = document.getElementById('day-content');
            const themeClass = day.country === 'Japon' ? 'bg-jp' : (day.country === 'Philippines' ? 'bg-ph' : 'bg-intl');
            const isChallengeDone = localStorage.getItem('challenge_'+day.id) === 'true';
            
            let animClass = '';
            if (direction === 'right') animClass = 'slide-in-right';
            if (direction === 'left') animClass = 'slide-in-left';

            let suggestionsHtml = "";
            if(day.suggestions && day.suggestions.length > 0) {
                suggestionsHtml = `
                    <div style="margin-top:20px; background:#fff3e0; padding:15px; border-radius:12px; border-left:4px solid var(--suggestion);">
                        <h4 style="margin-bottom:10px; color:#e65100; font-size:1rem;"><i class="fas fa-lightbulb"></i> Id√©es temps libre</h4>
                        ${day.suggestions.map(s => `<div style="margin-bottom:8px; font-size:0.95rem;"><strong><a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.title + " " + day.location)}" target="_blank" class="map-link">${s.title} <i class="fas fa-external-link-alt map-icon-small"></i></a></strong>: ${s.desc}</div>`).join('')}
                    </div>
                `;
            }

            container.innerHTML = `
                <div class="day-card ${animClass}">
                    <div class="day-header ${themeClass}">
                        <div>
                            <h2 style="font-size:1.4rem;">${day.date.toLocaleDateString('fr-FR', {weekday: 'long', day: 'numeric', month: 'long'})}</h2>
                            <p style="font-size:1rem; opacity:0.9;"><i class="fas fa-map-marker-alt"></i> ${day.location}, ${day.country}</p>
                        </div>
                        <i class="fas ${day.country === 'Japon' ? 'fa-torii-gate' : (day.country === 'Philippines' ? 'fa-sun' : 'fa-plane')} fa-2x"></i>
                    </div>
                    
                    <div class="challenge-card ${isChallengeDone ? 'completed' : ''}" id="chal-${day.id}">
                        <div class="challenge-header" onclick="this.nextElementSibling.classList.toggle('open')">
                            <i class="fas fa-camera" style="font-size:1.2rem;"></i> 
                            <strong style="flex:1; font-size:1rem;">${isChallengeDone ? 'Souvenir cr√©√© !' : day.challenge.title}</strong>
                            ${isChallengeDone ? 
                                `<button onclick="event.stopPropagation(); undoChallenge(${day.id})" class="undo-btn"><i class="fas fa-trash"></i></button>` : 
                                '<i class="fas fa-chevron-down"></i>'
                            }
                        </div>
                        <div class="challenge-body">
                            <p style="font-size:0.95rem; line-height:1.4;">${day.challenge.desc}</p>
                            <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:8px; margin:10px 0; font-size:0.85rem;">
                                üí° ${day.challenge.hint}
                            </div>
                            ${!isChallengeDone ? `
                                <label class="camera-btn-label">
                                    <i class="fas fa-camera" style="font-size:1.5rem; color:var(--primary);"></i> Ouvrir l'appareil photo
                                    <input type="file" accept="image/*" capture="environment" style="display:none" onchange="handleCamera(event, ${day.id})">
                                </label>` 
                            : ''}
                        </div>
                    </div>

                    <div class="timeline">
                        ${day.activities.map(act => `
                            <div class="activity">
                                <div style="color:var(--primary);font-weight:bold; font-size:0.9rem;">${act.time}</div>
                                <strong style="font-size:1rem;">
                                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(act.title + " " + day.location)}" target="_blank" class="map-link">
                                        ${act.title} <i class="fas fa-external-link-alt map-icon-small"></i>
                                    </a>
                                </strong>
                                <p style="font-size:0.9rem; color:#666; margin-top:2px;">${act.desc}</p>
                            </div>
                        `).join('')}
                    </div>
                    
                    ${suggestionsHtml}

                    <div class="hotel-card">
                        <strong>üè® <a href="${day.hotel.link}" target="_blank" class="map-link" style="font-size:1.05rem;">${day.hotel.name} <i class="fas fa-external-link-alt map-icon-small"></i></a></strong><br>
                        <span style="font-size:0.95rem; color:#555;">${day.hotel.room}</span>
                    </div>
                </div>
            `;
        }

        function completeChallenge(id) {
            localStorage.setItem('challenge_'+id, 'true');
            renderDay(currentDayIndex);
            if(navigator.vibrate) navigator.vibrate(200);
        }

        function undoChallenge(id) {
            if(confirm("Voulez-vous vraiment annuler ce d√©fi ?")) {
                localStorage.removeItem('challenge_'+id);
                renderDay(currentDayIndex);
            }
        }

        function handleCamera(event, id) {
            if (event.target.files && event.target.files.length > 0) {
                completeChallenge(id);
            }
        }
        
        function renderHotels() {
             const list = document.getElementById('hotels-list');
             if (list) {
                 list.innerHTML = voyageData.hotels.map(h => `
                    <div class="day-card" style="padding:20px;">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <h3 style="margin:0; font-size:1.2rem;">${h.name}</h3>
                            <div style="color:#fbc02d; font-size:0.9rem;">${"‚≠ê".repeat(h.stars)}</div>
                        </div>
                        <p style="color:#666; margin:5px 0; font-size:0.95rem;"><i class="fas fa-map-pin"></i> ${h.city}</p>
                        <p style="font-size:0.95rem; margin-bottom:15px; line-height:1.4;">${h.desc}</p>
                        
                        <div class="hotel-details">
                            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                                <span>üïí In: <strong>${h.checkIn}</strong></span>
                                <span>Out: <strong>${h.checkOut}</strong></span>
                            </div>
                            <div style="margin-top:8px;">
                                ${h.amenities.map(a => `<span class="hotel-badge">${a}</span>`).join('')}
                            </div>
                        </div>
                        
                        <!-- BOUTONS D'ACTION POUR L'H√îTEL -->
                        <div class="hotel-actions">
                            <a href="tel:${h.phone}" class="hotel-action-btn hotel-call-btn">
                                <i class="fas fa-phone"></i> Appeler
                            </a>
                            <a href="${h.website}" target="_blank" class="hotel-action-btn hotel-website-btn">
                                <i class="fas fa-globe"></i> Site Web
                            </a>
                            <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.name + ' ' + h.city)}" target="_blank" class="hotel-action-btn hotel-map-btn">
                                <i class="fas fa-map-marked-alt"></i> Localiser
                            </a>
                        </div>
                        
                        <div style="margin-top:15px; padding-top:15px; border-top:1px solid #eee; font-size:0.85rem; color:#666;">
                            <i class="fas fa-phone-alt"></i> <strong>T√©l√©phone:</strong> 
                            <a href="tel:${h.phone}" style="color:var(--primary); text-decoration:none; font-weight:bold;">
                                ${formatPhoneNumber(h.phone)}
                            </a>
                        </div>
                    </div>
                 `).join('');
             }
        }
        
        /* Fonction pour formater les num√©ros de t√©l√©phone */
        function formatPhoneNumber(phone) {
            if (!phone) return "Non disponible";
            
            // Format international : +33 1 23 45 67 89
            const cleaned = phone.replace(/\D/g, '');
            
            if (cleaned.startsWith('81')) { // Japon
                return phone;
            } else if (cleaned.startsWith('63')) { // Philippines
                return phone;
            } else if (cleaned.startsWith('33')) { // France
                return phone;
            }
            
            return phone;
        }

        function initMap() {
            if(map) return;
            map = L.map('map-container', {zoomControl: false}).setView([25, 130], 4);
            L.control.zoom({position: 'bottomright'}).addTo(map);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: ''}).addTo(map);
            
            voyageData.hotels.forEach(h => {
                if(h.coords) {
                    const icon = L.divIcon({
                        className: 'custom-div-icon',
                        html: `<div class="marker-pin" style="background:#2196f3;"><i class="fas fa-bed"></i></div>`,
                        iconSize: [30, 42], iconAnchor: [15, 42]
                    });
                    L.marker(h.coords, {icon: icon}).addTo(map).bindPopup(`<b>${h.name}</b><br>H√¥tel`);
                }
            });

            voyageData.days.forEach(d => {
                d.activities.forEach(act => {
                    if(act.coords) {
                         const iconAct = L.divIcon({
                            className: 'custom-div-icon',
                            html: `<div class="marker-pin" style="background:#e91e63;"><i class="fas fa-camera"></i></div>`,
                            iconSize: [30, 42], iconAnchor: [15, 42]
                        });
                        L.marker(act.coords, {icon: iconAct}).addTo(map).bindPopup(`<b>Jour ${d.id}: ${act.title}</b><br>${act.desc}`);
                    }
                });
                if(d.suggestions) {
                    d.suggestions.forEach(s => {
                        const iconSugg = L.divIcon({
                            className: 'custom-div-icon',
                            html: `<div class="marker-pin" style="background:#ff9800;"><i class="fas fa-lightbulb"></i></div>`,
                            iconSize: [30, 42], iconAnchor: [15, 42]
                        });
                        L.marker(s.coords, {icon: iconSugg}).addTo(map).bindPopup(`<b>Suggestion: ${s.title}</b><br>${s.desc}`);
                    });
                }
            });
            
            updateUserMarker();
        }
        
        function updateUserMarker() {
            if (!map) return;
            
            const now = new Date();
            const tripStart = voyageData.days[0].date;
            const tripEnd = voyageData.days[voyageData.days.length - 1].date;
            
            const tripEndBuffer = new Date(tripEnd);
            tripEndBuffer.setDate(tripEndBuffer.getDate() + 1);

            const isDuringTrip = now >= tripStart && now < tripEndBuffer;

            if (realUserLocation && isDuringTrip) {
                if (userMarker) {
                    userMarker.setLatLng([realUserLocation.lat, realUserLocation.lng]);
                } else {
                    const userIcon = L.divIcon({
                        className: 'custom-div-icon',
                        html: `<div class="user-pin"></div>`,
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    });
                    userMarker = L.marker([realUserLocation.lat, realUserLocation.lng], {icon: userIcon}).addTo(map).bindPopup("Vous √™tes ici üìç");
                }
            }
        }
        
        /* --- CONVERTISSEUR --- */
        async function updateRates() {
            const btn = document.getElementById('btn-update-rates');
            const info = document.getElementById('rate-info');
            if(!btn) return;
            
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRLLj3YWEjnNtTwjxM_6CZCB354sMQFQNaW0JkldsHsr-NFn7nHXQ6oxM73bUuuEbPMxTftpnkHb7fy/pub?gid=0&single=true&output=csv';
            
            try {
                const response = await fetch(sheetUrl);
                const text = await response.text();
                const rows = text.split('\n').map(row => {
                    const cols = row.split(',');
                    return cols.length > 1 ? parseFloat(cols[1]) : parseFloat(cols[0]);
                });
                if (rows.length >= 4) {
                    exchangeRates["EUR-JPY"] = rows[0]; exchangeRates["JPY-EUR"] = rows[1];
                    exchangeRates["EUR-PHP"] = rows[2]; exchangeRates["PHP-EUR"] = rows[3];
                    
                    btn.innerHTML = '<i class="fas fa-check"></i>';
                    btn.style.background = "var(--success)";
                    info.innerText = "Mis √† jour √† " + new Date().toLocaleTimeString().slice(0,5);
                    convertCurrency();
                    setTimeout(() => { btn.innerHTML = originalText; btn.style.background = "var(--secondary)"; }, 2000);
                }
            } catch (error) {
                console.error("Erreur taux:", error);
                btn.innerHTML = '<i class="fas fa-times"></i>';
                btn.style.background = "#f44336";
                setTimeout(() => { btn.innerHTML = originalText; btn.style.background = "var(--secondary)"; }, 2000);
            }
        }

        function convertCurrency() {
            const amount = parseFloat(document.getElementById('amount-from').value);
            const from = document.getElementById('curr-from').value;
            const to = document.getElementById('curr-to').value;
            const resultDiv = document.getElementById('conversion-result');
            if (isNaN(amount)) { resultDiv.innerText = "---"; return; }
            if (from === to) { resultDiv.innerText = amount.toFixed(2); return; }
            let rate = 0;
            const pair = `${from}-${to}`;
            if (exchangeRates[pair]) { rate = exchangeRates[pair]; } 
            else {
                const toEuro = `${from}-EUR`; const fromEuro = `EUR-${to}`;
                if (exchangeRates[toEuro] && exchangeRates[fromEuro]) { rate = exchangeRates[toEuro] * exchangeRates[fromEuro]; }
            }
            if (rate > 0) { resultDiv.innerText = (amount * rate).toFixed(2); } 
            else { resultDiv.innerText = "?"; }
        }

        function swapCurrency() {
            const fromEl = document.getElementById('curr-from');
            const toEl = document.getElementById('curr-to');
            const temp = fromEl.value; fromEl.value = toEl.value; toEl.value = temp;
            convertCurrency();
        }

        /* --- UTILS --- */
        function setupSwipe() {
            const container = document.getElementById('day-content');
            let touchStartX = 0; let touchEndX = 0; const minSwipeDistance = 50;
            container.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive: true});
            container.addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; handleSwipe(container, 'day'); }, {passive: true});
            
            const overviewContainer = document.getElementById('overview-container');
            let touchStartOverview = 0;
            overviewContainer.addEventListener('touchstart', e => { touchStartOverview = e.changedTouches[0].screenX; }, {passive: true});

            function handleSwipe(el, mode) {
                const distance = touchEndX - touchStartX;
                if (Math.abs(distance) < minSwipeDistance) return;
                if (distance > 0) { if(mode==='day') changeDay(-1, 'left'); } 
                else { if(mode==='day') changeDay(1, 'right'); }
            }
        }

        function enterApp() {
            document.getElementById('landing-page').style.transform = 'translateY(-100%)';
            document.getElementById('app-interface').style.display = 'block';
            setTimeout(() => { document.getElementById('app-interface').style.opacity = '1'; initMap(); }, 500);
        }
    </script>
</body>
</html>
